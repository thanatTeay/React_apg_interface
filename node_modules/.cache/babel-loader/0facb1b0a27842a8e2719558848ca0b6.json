{"ast":null,"code":"import _slicedToArray from\"D:/Hobbies/apg-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect}from'react';import{Redirect}from'react-router-dom';import{AuthContext}from'./auth';import firebaseConfig from'../config';import Nav from'./Nav';import Twitch from'./Twitch';import BtnP1 from'./BtnP1';import{Alert,Confirm}from'react-st-modal';import IdleTimerContainer from'./IdleTimer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MainP1=function MainP1(){//const db = firebaseConfig.firestore();\n//let countUser=0;\nvar _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;//let checkUser = false;\nvar db=firebaseConfig.firestore();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),checkUser=_useState2[0],setcheckUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isRunning=_useState4[0],setIsRunning=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),seconds=_useState6[0],setSeconds=_useState6[1];var checkTotalUser;var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),count=_useState8[0],setCount=_useState8[1];function getCurrentUserOnWeb(){//console.log(\"czxczxczxc\")\ndb.collection('countuser').doc('onweb').onSnapshot(function(doc){var item=[];item.push(doc.data());setCount(item);checkTotalUser=doc.data().p1team;//alert(count)\n//alert(doc.data().p1team)\n});}function checkAnswered(){db.collection('user').doc(currentUser.uid).get().then(function(data){var checkanswer1=data.data().answerFirstQuestion;if(!checkanswer1){db.collection('user').doc(currentUser.uid).update({isOnline:false,isP1team:false,isP2team:false}).then(function(){firebaseConfig.auth().signOut();}).catch(function(error){var errorMessage=error.message;alert(errorMessage,'Error!');//alert(errorMessage);\n});}else{getCurrentUserOnWeb();Alert(\"Welcome to Player 1 team!!!!!\",'Welcome');}});}useEffect(function(){//console.log(count)\n//console.log(\"asdasdasdasd\")\nif(currentUser){//setcheckUser(true);\ncheckAnswered();}window.onbeforeunload=confirmExit;function confirmExit(){db.collection('user').doc(currentUser.uid).update({isOnline:false,isP1team:false,isP2team:false}).then(function(){firebaseConfig.auth().signOut();}).catch(function(error){var errorMessage=error.message;alert(errorMessage,'Error!');//alert(errorMessage);\n});}},[]);useEffect(function(){if(isRunning){//alert(\"re\")\nvar id=window.setInterval(function(){db.collection('user').doc(currentUser.uid).get().then(function(data){var checkanswer1=data.data().answerFirstQuestion;var checkanswer2=data.data().answerSecordQuestion;setSeconds(function(seconds){return seconds+1;});if(checkanswer1&&checkanswer2){setIsRunning(function(isRunning){return false;});console.log(checkanswer1,checkanswer2);//console.log(\"isRunning:\"+isRunning)\n}else{setIsRunning(function(isRunning){return false;});window.location.href=\"/submit2\";// Ð¡onfirmation confirmed\n//Alert(\"Please do the second questionnaire on this link:\" + \" https://www.surveymonkey.com/r/6KHX3TK.\", 'Please do a questionnaire');\n//window.location.href = \"/submit2\"\n}//console.log(\"isRunning:\"+isRunning)\n});},360000);//console.log(\"isRunning:\"+isRunning)\nreturn function(){return window.clearInterval(id);};}},[isRunning]);if(!currentUser){//setcheckUser(true);\nreturn/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}if(currentUser&&checkUser){db.collection('user').doc(currentUser.uid).update({isOnline:true,isP2team:false,isP1team:true});//setcheckLogout(false)\nsetcheckUser(false);//alert(\"logout\")\n}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Nav,{}),/*#__PURE__*/_jsx(Twitch,{}),/*#__PURE__*/_jsx(BtnP1,{}),/*#__PURE__*/_jsx(IdleTimerContainer,{})]});};export default MainP1;","map":{"version":3,"sources":["D:/Hobbies/apg-interface/src/components/MainP1.js"],"names":["React","useContext","useState","useEffect","Redirect","AuthContext","firebaseConfig","Nav","Twitch","BtnP1","Alert","Confirm","IdleTimerContainer","MainP1","currentUser","db","firestore","checkUser","setcheckUser","isRunning","setIsRunning","seconds","setSeconds","checkTotalUser","count","setCount","getCurrentUserOnWeb","collection","doc","onSnapshot","item","push","data","p1team","checkAnswered","uid","get","then","checkanswer1","answerFirstQuestion","update","isOnline","isP1team","isP2team","auth","signOut","catch","error","errorMessage","message","alert","window","onbeforeunload","confirmExit","id","setInterval","checkanswer2","answerSecordQuestion","console","log","location","href","clearInterval"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from 'react'\r\nimport { Redirect } from 'react-router-dom'\r\nimport { AuthContext } from './auth'\r\nimport firebaseConfig from '../config'\r\nimport Nav from './Nav'\r\nimport Twitch from './Twitch'\r\nimport BtnP1 from './BtnP1'\r\nimport { Alert, Confirm } from 'react-st-modal'\r\nimport IdleTimerContainer from './IdleTimer'\r\n\r\n\r\nconst MainP1 = () => {\r\n\r\n    //const db = firebaseConfig.firestore();\r\n    //let countUser=0;\r\n    const { currentUser } = useContext(AuthContext);\r\n    //let checkUser = false;\r\n    const db = firebaseConfig.firestore();\r\n    const [checkUser, setcheckUser] = useState(true);\r\n    const [isRunning, setIsRunning] = useState(true);\r\n    const [seconds, setSeconds] = useState(0);\r\n\r\n\r\n    let checkTotalUser;\r\n    const [count, setCount] = useState([])\r\n    function getCurrentUserOnWeb() {\r\n        //console.log(\"czxczxczxc\")\r\n        db.collection('countuser').doc('onweb').onSnapshot(doc => {\r\n            const item = [];\r\n            item.push(doc.data())\r\n            setCount(item);\r\n            checkTotalUser = doc.data().p1team\r\n            //alert(count)\r\n            //alert(doc.data().p1team)\r\n        })\r\n\r\n    }\r\n\r\n    function checkAnswered() {\r\n        db.collection('user').doc(currentUser.uid).get().then(data => {\r\n            const checkanswer1 = data.data().answerFirstQuestion\r\n            if (!checkanswer1) {\r\n                db.collection('user').doc(currentUser.uid).update({\r\n\r\n                    isOnline: false,\r\n                    isP1team: false,\r\n                    isP2team: false,\r\n\r\n                }).then(() => {\r\n                    firebaseConfig.auth().signOut()\r\n                }).catch(error => {\r\n                    var errorMessage = error.message;\r\n                    alert(errorMessage, 'Error!');\r\n                    //alert(errorMessage);\r\n                })\r\n            }\r\n            else {\r\n                getCurrentUserOnWeb();\r\n                Alert(\"Welcome to Player 1 team!!!!!\", 'Welcome')\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        //console.log(count)\r\n        //console.log(\"asdasdasdasd\")\r\n        if (currentUser) {\r\n            //setcheckUser(true);\r\n            checkAnswered();\r\n        }\r\n        window.onbeforeunload = confirmExit;\r\n\r\n        function confirmExit() {\r\n            db.collection('user').doc(currentUser.uid).update({\r\n\r\n                isOnline: false,\r\n                isP1team: false,\r\n                isP2team: false,\r\n\r\n            }).then(() => {\r\n                firebaseConfig.auth().signOut()\r\n            }).catch(error => {\r\n                var errorMessage = error.message;\r\n                alert(errorMessage, 'Error!');\r\n                //alert(errorMessage);\r\n            })\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (isRunning) {\r\n            //alert(\"re\")\r\n            const id = window.setInterval(() => {\r\n                db.collection('user').doc(currentUser.uid).get().then(data => {\r\n                    const checkanswer1 = data.data().answerFirstQuestion\r\n                    const checkanswer2 = data.data().answerSecordQuestion\r\n                    setSeconds(seconds => seconds + 1)\r\n                    if (checkanswer1 && checkanswer2) {\r\n                        setIsRunning(isRunning => false)\r\n                        console.log(checkanswer1, checkanswer2)\r\n                        //console.log(\"isRunning:\"+isRunning)\r\n                    }\r\n                    else {\r\n\r\n\r\n                        setIsRunning(isRunning => false)\r\n                        window.location.href = \"/submit2\"\r\n                        // Ð¡onfirmation confirmed\r\n\r\n\r\n                        //Alert(\"Please do the second questionnaire on this link:\" + \" https://www.surveymonkey.com/r/6KHX3TK.\", 'Please do a questionnaire');\r\n                        //window.location.href = \"/submit2\"\r\n                    }\r\n\r\n                    //console.log(\"isRunning:\"+isRunning)\r\n                })\r\n\r\n            }, 360000)\r\n            //console.log(\"isRunning:\"+isRunning)\r\n            return () => window.clearInterval(id);\r\n        }\r\n\r\n    }, [isRunning])\r\n\r\n\r\n    if (!currentUser) {\r\n\r\n        //setcheckUser(true);\r\n        return <Redirect to=\"/login\" />;\r\n    }\r\n\r\n    if (currentUser && checkUser) {\r\n        db.collection('user').doc(currentUser.uid).update({\r\n            isOnline: true,\r\n            isP2team: false,\r\n            isP1team: true\r\n\r\n        })\r\n        //setcheckLogout(false)\r\n        setcheckUser(false);\r\n        //alert(\"logout\")\r\n\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Nav />\r\n            <Twitch />\r\n            <BtnP1 />\r\n            <IdleTimerContainer></IdleTimerContainer>\r\n\r\n\r\n\r\n        </div>\r\n\r\n    )\r\n\r\n}\r\n\r\nexport default MainP1;"]},"metadata":{},"sourceType":"module"}